<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เปรียบเทียบสินค้า | FINFUR</title>
    <link rel="icon" type="image/png" href="/images/logo_main.png">
</head>

<body class="bg-white text-black dark:bg-gray-900">
    <!-- 1 -->
    <div id="navbarContainer">
        <div id="defaultNavbar">
            <%- include('partials/narbar') %>
        </div>
        <div id="searchNavbar" style="display: none;">
            <%- include('partials/narbar_search') %>
        </div>
    </div>
    <!-- 1 -->
    <div class="px-10 mt-10 dark:invert dark:brightness-75">
        <h1 class="text-3xl font-bold text-gray-900 mb-6">เปรียบเทียบสินค้าใน รายการโปรดตามหมวดหมู่</h1>
        <ol class="list-decimal pl-6 space-y-2 text-gray-900">
            <li class="font-semibold">เลือกสินค้า</li>
            <ul class="list-disc pl-6 text-gray-700">
                <li>เลือกสินค้า 2 รายการเพื่อทำการเปรียบเทียบ</li>
            </ul>
            <li class="font-semibold">ทำการเปรียบเทียบ</li>
        </ol>
    </div>

    <div class="mt-10 gap-10">
        <div class="p-5">
            <button
                class="right-4 w-[200px] h-[50px] bg-[#FFEF00] font-bold rounded-[20px] flex items-center justify-center teshadow dark:text-black"
                onclick="toggleCompare()">
                เปรียบเทียบสินค้าเลย!
            </button>
        </div>

        <!-- <div class="relative flex items-center justify-center px-4 py-2 rounded-lg w-full gap-10">
        <div class="w-full h-[700px] max-w-[700px] min-w-[300px] bg-blue-600 rounded-lg p-4 shadow-lg shadow-[rgba(0,0,0,0.5)]">
            <div class="flex items-center justify-center w-full gap-2 bg-blue-600 font-bold mt-[20px]">
                <h3 class="text-white text-2xl">เลือกสินค้าชิ้นที่ 1
                    <input type="checkbox" class="w-5 h-5" id="checkbox1" disabled>
                </h3>   
            </div >
            <div class=" rounded-lg overflow-auto p-4 h-[600px]">
                <div class="relative flex flex-wrap items-center justify-center gap-10 mt-10 ">
                    <div id="1-box1" class="bg-white w-[200px] h-[300px] min-w-[200px] min-h-[300px] hover:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] active:shadow-[8px_8px_20px_0px_rgba(0,0,0,0.5)] focus:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] transition-shadow duration-300 "></div>
                    <div id="1-box2" class="bg-white w-[200px] h-[300px] min-w-[200px] min-h-[300px] hover:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] active:shadow-[8px_8px_20px_0px_rgba(0,0,0,0.5)] focus:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] transition-shadow duration-300 "></div>
                    <div id="1-box3" class="bg-white w-[200px] h-[300px] min-w-[200px] min-h-[300px] hover:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] active:shadow-[8px_8px_20px_0px_rgba(0,0,0,0.5)] focus:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] transition-shadow duration-300 "></div>
                    <div id="1-box4" class="bg-white w-[200px] h-[300px] min-w-[200px] min-h-[300px] hover:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] active:shadow-[8px_8px_20px_0px_rgba(0,0,0,0.5)] focus:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] transition-shadow duration-300 "></div>
                </div>   
            </div>
        </div>
    
        <div class="w-full h-[700px] max-w-[700px] min-w-[300px] bg-blue-600 rounded-lg p-4 shadow-lg shadow-[rgba(0,0,0,0.5)]">
            <div class="flex items-center justify-center w-full gap-2 bg-blue-600 font-bold mt-[20px]">
                 <h3 class="text-white text-2xl">เลือกสินค้าชิ้นที่ 2
                    <input type="checkbox" class="w-5 h-5" id="checkbox2" disabled>
                </h3> 
            </div>  
            <div class=" rounded-lg overflow-auto p-4 h-[600px]">
                <div class="relative flex flex-wrap items-center justify-center gap-10 mt-10">
                    <div id="2-box1" class="bg-white w-[200px] h-[300px] min-w-[200px] min-h-[300px] hover:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] active:shadow-[8px_8px_20px_0px_rgba(0,0,0,0.5)] focus:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] transition-shadow duration-300 "></div>
                    <div id="2-box2" class="bg-white w-[200px] h-[300px] min-w-[200px] min-h-[300px] hover:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] active:shadow-[8px_8px_20px_0px_rgba(0,0,0,0.5)] focus:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] transition-shadow duration-300 "></div>
                </div>
            </div>    
        </div>
    </div> -->

        <div class="relative flex flex-wrap items-start justify-start px-4 py-2 rounded-lg w-full gap-10">
            <% if (product.length> 0) { %>
                <% let currentCategory=null; %>
                    <% let categoryCount=0; %>
                        <% product.forEach(product=> { %>
                            <% if (currentCategory !==product.categoryID) { %>
                                <% if (currentCategory !==null) { %>
        </div> <!-- ปิด div ของสินค้าในหมวดหมู่ก่อนหน้า -->
    </div> <!-- ปิด div ของหมวดหมู่ก่อนหน้า -->
    </div> <!-- ปิด div ของพื้นหลังสีน้ำเงิน -->
    <% } %>
        <% currentCategory=product.categoryID; %>
            <% categoryCount++; %>
                <% if (categoryCount % 2===1) { %>
                    <div class="flex flex-wrap w-full gap-10"> <!-- เริ่มแถวใหม่ทุก 2 หมวดหมู่ -->
                        <% } %>
                            <div class="flex-1 bg-blue-600 rounded-lg p-4 shadow-lg shadow-[rgba(0,0,0,0.5)]">
                                <div
                                    class="flex items-center justify-center w-full gap-2 bg-blue-600 font-bold mt-[20px]">
                                    <h3 class="text-white text-2xl">หมวดหมู่: <%= product.categoryName %>
                                    </h3>
                                </div>
                                <div class="rounded-lg overflow-auto p-4">
                                    <div class="grid grid-cols-2 gap-6 mt-10"> <!-- แสดงสินค้า 2 ชิ้นต่อแถว -->
                                        <% } %>
                                            <div class="bg-white rounded-lg p-4 shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] hover:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] active:shadow-[8px_8px_20px_0px_rgba(0,0,0,0.5)] focus:shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)] transition-shadow duration-300 ease-in-out"
                                                onclick="selectProduct(this, '<%= product.productID %>')">
                                                <a href="/product/<%= product.productID %>">
                                                    <img class="rounded-lg w-full h-auto"
                                                        src="/images/allProduct/<%= product.productID %>.png"
                                                        alt="<%= product.productName %> Image">
                                                </a>
                                                <h3 class="font-semibold mt-2">
                                                    <%= product.productName %>
                                                </h3>
                                                <p class="text-gray-700">
                                                    <%= product.description %>
                                                </p>
                                                <p class="text-gray-700">ราคา: <%= product.price %> บาท</p>
                                            </div>

                                            <% }); %>
                                                <% } %>
                                    </div>





                                    <!-- Pop-up กล่องที่จะแสดงเมื่อคลิกปุ่ม -->
                                    <!-- Pop-up ที่จะแสดงเมื่อคลิกปุ่ม "เปรียบเทียบสินค้า" -->
                                    <div id="popup"
                                        class="fixed top-0 left-0 w-screen h-screen bg-black bg-opacity-80 hidden grid justify-center items-center">
                                        <h3 class="mt-10 text-white text-2xl font-bold">เปรียบเทียบสินค้าใน รายการโปรด
                                        </h3>
                                        <div class="p-6 rounded-lg flex gap-6 w-[80vw] h-[80vh] shadow-2xl">
                                            <!-- กล่องที่ 1 (แสดงสินค้า 1 ที่เลือก) -->
                                            <div
                                                class="bg-white flex-1 rounded-lg shadow-lg w-[400px] h-[500px] min-w-[250px] min-h-[350px] max-w-[400px]">
                                                <h3>สินค้า 1</h3>
                                                <p>แสดงรายละเอียดสินค้า 1 ที่เลือกที่นี่</p>
                                            </div>
                                            <!-- กล่องที่ 2 (แสดงสินค้า 2 ที่เลือก) -->
                                            <div
                                                class="bg-white flex-1 rounded-lg shadow-lg w-[400px] h-[500px] min-w-[250px] min-h-[350px] max-w-[400px]">
                                                <h3>สินค้า 2</h3>
                                                <p>แสดงรายละเอียดสินค้า 2 ที่เลือกที่นี่</p>
                                            </div>
                                        </div>
                                        <div class="h-full mt-[15%]">
                                            <button
                                                class="w-[220px] h-[70px] bg-[#FFEF00] font-bold rounded-[20px] flex items-center justify-center teshadow"
                                                onclick="closePopup()">เลือกสินค้าที่ต้องการจะเปรียบเทียบใหม่</button>
                                        </div>
                                        <!-- ปุ่มปิด Pop-up -->
                                        <button id="popup-close" class="absolute top-4 right-4 text-white font-bold"
                                            onclick="closePopup()">X</button>
                                    </div>

                                </div>
                                <script>

                                    let selectedProducts = [];

                                    function selectProduct(element, productID) {
                                        if (selectedProducts.includes(productID)) {
                                            selectedProducts = selectedProducts.filter(id => id !== productID);
                                            element.classList.remove("selected");
                                        } else {
                                            if (selectedProducts.length < 2) {
                                                selectedProducts.push(productID);
                                                element.classList.add("selected");
                                            } else {
                                                alert("คุณสามารถเลือกได้เพียง 2 สินค้า");
                                            }
                                        }
                                    }

                                    function compareProducts() {
                                        if (selectedProducts.length === 2) {
                                            // ทำการเปรียบเทียบสินค้า
                                            console.log("เปรียบเทียบสินค้า:", selectedProducts);
                                            alert("กำลังเปรียบเทียบสินค้า: " + selectedProducts.join(", "));
                                        } else {
                                            alert("กรุณาเลือกสินค้า 2 รายการเพื่อทำการเปรียบเทียบ");
                                        }
                                    }

                                    // Add event listeners to the boxes
                                    document.getElementById("1-box1").addEventListener("click", function () {
                                        handleClick("1-box1", "checkbox1");
                                    });

                                    document.getElementById("1-box2").addEventListener("click", function () {
                                        handleClick("1-box2", "checkbox1");
                                    });

                                    document.getElementById("1-box3").addEventListener("click", function () {
                                        handleClick("1-box3", "checkbox1");
                                    });
                                    document.getElementById("1-box4").addEventListener("click", function () {
                                        handleClick("1-box4", "checkbox1");
                                    });

                                    // Add event listeners to the boxes
                                    document.getElementById("2-box1").addEventListener("click", function () {
                                        handleClick("2-box1", "checkbox2");
                                    });

                                    document.getElementById("2-box2").addEventListener("click", function () {
                                        handleClick("2-box2", "checkbox2");
                                    });

                                    function handleClick(boxId, checkboxId) {
                                        const box = document.getElementById(boxId);
                                        const checkbox = document.getElementById(checkboxId);

                                        // Toggle checkbox value
                                        checkbox.checked = !checkbox.checked;

                                        // Toggle shadow based on checkbox status
                                        if (checkbox.checked) {
                                            box.classList.add("shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)]");
                                        } else {
                                            box.classList.remove("shadow-[8px_8px_5px_0px_rgba(0,0,0,0.5)]");
                                        }
                                    }

                                    function closePopup() {
                                        const popup = document.getElementById("popup");
                                        popup.classList.add('hidden'); // ซ่อน Pop-up
                                        selectedProducts = []; // รีเซ็ตการเลือกสินค้า
                                        document.querySelectorAll('.selected').forEach(element => element.classList.remove("selected")); // ลบคลาส selected
                                    }

                                    function checkCheckboxes() {
                                        // ตรวจสอบสถานะของ checkbox1 และ checkbox2
                                        let isCheckbox1Checked = document.getElementById("checkbox1").checked;
                                        let isCheckbox2Checked = document.getElementById("checkbox2").checked;

                                        // ถ้าทั้ง checkbox1 และ checkbox2 ถูกเลือก
                                        if (isCheckbox1Checked && isCheckbox2Checked) {
                                            console.log("ทั้ง checkbox1 และ checkbox2 ถูกเลือก!");
                                            // ทำการอัปเดต navbar หรือการแสดงผลต่าง ๆ ที่ต้องการที่นี่
                                            sessionStorage.setItem("searchMode", "true");
                                        } else {
                                            console.log("ไม่ครบทั้งสอง checkbox หรือยังไม่ได้เลือก");
                                            // อัปเดตค่า sessionStorage เพื่อปิดการแสดงผลบางอย่าง
                                            sessionStorage.setItem("searchMode", "false");
                                        }
                                    }
                                    // ฟังก์ชันในการแสดงหรือซ่อน popup
                                    function toggleCompare() {
                                        if (selectedProducts.length === 2) {
                                            // ถ้าเลือกสินค้าครบ 2 ชิ้นแล้ว
                                            const popup = document.getElementById("popup");

                                            // แสดงหรือซ่อน Pop-up
                                            if (popup.classList.contains('hidden')) {
                                                popup.classList.remove('hidden');
                                            } else {
                                                popup.classList.add('hidden');
                                            }
                                        } else {
                                            alert("กรุณาเลือกสินค้าสองชิ้นเพื่อเปรียบเทียบ");
                                        }
                                    }

                                    function toggleSearch(event) {
                                        event.preventDefault();
                                        let searchMode = sessionStorage.getItem("searchMode") === "true";
                                        sessionStorage.setItem("searchMode", !searchMode);

                                        updateNavbar(); // เรียกฟังก์ชันเปลี่ยน navbar
                                    }

                                    function updateNavbar() {
                                        let searchMode = sessionStorage.getItem("searchMode") === "true";
                                        document.getElementById("defaultNavbar").style.display = searchMode ? "none" : "block";
                                        document.getElementById("searchNavbar").style.display = searchMode ? "block" : "none";
                                    }

                                    // ตรวจสอบเมื่อโหลดหน้า
                                    document.addEventListener("DOMContentLoaded", updateNavbar);
                                </script>
                                <!-- 2 -->
</body>

</html>